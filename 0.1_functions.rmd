---
title: "0.1_functions"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
source("PAS_design.R")
```

```{r PAS_design}

#this function created  an dds object 
PAS_design<-function(x, PAS, anno){
  dds<-DESeqDataSetFromMatrix(countData = PAS, 
                              colData = anno, 
                              design = x)
  keep<-rowSums(counts(dds)) >=10
  dds<-dds[keep,]
}

x <- ~ Grav + Para + sectio + Csec + place

dds<-PAS_design( x, PAS, anno )
```


```{r}
PAS_results <- function(dds, name, contrast){
    dds <- DESeq(dds)
results <- results(dds)
results <-results(dds, name= name)
results <-results(dds, filterFun= ihw, contrast = contrast)

return (results)
}
name= "place_PAS_vs_ctrl"
name <- list(c("place_PAS_vs_ctrl", "place_mus_vs_ctrl"))
contrast = c("place", "PAS", "ctrl")

res<-PAS_results(dds, name, contrast)

contrasts<- list("PAS_ctrl"= c("place", "PAS", "ctrl"), "mus_ctrl"= c("place", "mus", "ctrl"))

```

